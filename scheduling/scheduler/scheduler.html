<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <link rel="stylesheet" href="https://foxos.glitch.me/style.css">
    <link rel="stylesheet" href="https://foxos.glitch.me/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP&display=swap">
    <title>FoxOS - Docs</title>
  </head>
  <body>
    <div class="w3-top">
      <div class="w3-bar w3-border w3-border-orange w3-orange w3-card w3-large fox-bar">
        <a href="/" class="w3-bar-item w3-button w3-hover-none w3-border-orange w3-bottombar w3-hover-border-black">Home</a>
        <a href="/about/" class="w3-bar-item w3-button w3-hover-none w3-border-orange w3-bottombar w3-hover-border-black">About us</a>
        <a href="/docs/" class="w3-bar-item w3-button w3-hover-none w3-border-orange w3-bottombar w3-hover-border-black">Docs</a>
        <a href="https://github.com/TheUltimateFoxOS" class="w3-bar-item w3-button w3-hover-none w3-border-orange w3-bottombar w3-hover-border-black">GitHub</a>
      </div>
    </div>
    
    <header class="w3-container w3-orange w3-center" style="padding:50px 16px">
      <h1 class="w3-margin w3-jumbo">FoxOS</h1>
      <p class="w3-xlarge">FoxOS docs - scheduler.cpp</p>
    </header>
    
    <div class="fox-text">
      <div>
        <h2>init_sched</h2>
        <b>Signature:</b> <code>void init_sched()</code><br/>
        <b>Description:</b> Initialize the scheduler. This starts a empty idle task for every cpu core.<br/>
        <br/>
        <b>Return:</b> <code>void</code>
      </div>
      <hr>
      <div>
        <h2>new_task</h2>
        <b>Signature:</b> <code>task* new_task(void* entry)</code><br/>
        <b>Description:</b> Create a new task. The entry point passed can't be a elf file.<br/>
        <br/>
        <b>Parameters:</b><br/>
        <ul>
          <li><code>void* entry</code></li>
        </ul>
        <br/>
        <b>Return:</b> <code>task*</code>
      </div>
      <hr>
      <div>
        <h2>task_exit</h2>
        <b>Signature:</b> <code>void task_exit()</code><br/>
        <b>Description:</b> Terminate the current task. Marks the task as dead and then waits in a infinite loop until the next timer tick.<br/>
        <br/>
        <b>Return:</b> <code>void</code>
      </div>
      <hr>
      <div>
        <h2>load_elf</h2>
        <b>Signature:</b> <code>task* load_elf(void* ptr, uint64_t file_size, const char **argv, const char **envp)</code><br/>
        <b>Description:</b> Load an elf file into memory and start it. Here you can pass the argv and envp array.<br/>
        <br/>
        <b>Parameters:</b><br/>
        <ul>
          <li><code>void* ptr</code></li>
          <li><code>uint64_t file_size</code></li>
          <li><code>const char **argv</code></li>
          <li><code>const char **envp</code></li>
        </ul>
        <br/>
        <b>Return:</b> <code>task*</code>
      </div>
      <hr>
      <div>
        <h2>schedule</h2>
        <b>Signature:</b> <code>extern "C" void schedule(s_registers* regs)</code><br/>
        <b>Attributes:</b> <code>extern "C"</code><br/>
        <b>Description:</b> The main scheduler. Gets called from the timer interrupt. Loads the next task for the current core and delets the task if needed else it restores the cpu state and jumps to the task.<br/>
        <br/>
        <b>Parameters:</b><br/>
        <ul>
          <li><code>s_registers* regs</code></li>
        </ul>
        <br/>
        <b>Return:</b> <code>void</code>
      </div>
      <hr>
    </div>
  </body>
</html>